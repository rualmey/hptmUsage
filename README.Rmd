---
output: github_document
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# hptmUsage

<!-- badges: start -->
[![Project Status: WIP â€“ Initial development is in progress, but there has not yet been a stable, usable release suitable for the public.](https://www.repostatus.org/badges/latest/wip.svg)](https://www.repostatus.org/#wip)
[![License](https://img.shields.io/badge/license-GPLv3-blue)](https://www.gnu.org/licenses/gpl-3.0.en.html)
<!-- badges: end -->

Preprocessing, visualization, and analysis (e.g., differential usage) of histone post-translational modifications (hPTMs).
This package builds on the 'msqrob2PTM' workflow to enable robust and performant analysis of hPTM data.

## Installation

Install the development version of hptmUsage from GitHub with:

``` r
# Install using "pak", alternatively use `devtools::install_github()` or `renv::install()`
# install.packages("pak")
pak::pak("rualmey/hptmUsage")
```

This package requires the following software to be installed (and to be found on PATH):

* [MAFFT](https://mafft.cbrc.jp/alignment/software/) for multiple sequence alignment

* [Quarto](https://quarto.org/docs/get-started/) for reporting of results

## Usage

[Example code](/data-raw/hptm_benchmark.R) on the processing of a [benchmark dataset](https://doi.org/10.1039/D1MO00201E) is available in this repo.

Below, some basic functionality is shown:

```{r example}
# hptmUsage automatically loads QFeatures for its infrastructure
library(hptmUsage)

# Reading a Progenesis QIP all ion export
# As of now, this is the only supported input data format
hptmUsageData("all_ion_export.csv") |>
  readProgenesis()

# Retrieving histones from UniProt and aligning their sequences using MAFFT
# Note: this requires MAFFT to be on the system PATH
histonesFromUniprot() |>
 alignHistones()

# Match peptide sequences to the retrieved histones
ncbtoy |>
  matchHistones(aligned_histones$unaligned, 1)

# And more to be found in the example code above
```
