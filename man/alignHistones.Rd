% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/hptmMSA.R
\name{alignHistones}
\alias{alignHistones}
\title{Align Histone Sequences Using MAFFT}
\usage{
alignHistones(
  unaligned_histones = NULL,
  return_alignment = FALSE,
  output_path = "./out/msa/",
  overwrite = FALSE,
  use_profiles = TRUE,
  nondefault_refseq_names = NULL,
  return_only_original = TRUE,
  quiet = TRUE,
  num_cores = -1,
  ...
)
}
\arguments{
\item{unaligned_histones}{An optional \code{AAStringSetList} of histone sequences
to align, by family. If \code{NULL}, a default call to \code{\link[=histonesFromUniprot]{histonesFromUniprot()}}
is made, i.e., sequences from all five histone families (human and
reviewed) are retrieved.}

\item{return_alignment, output_path, overwrite}{Return the alignment? In order:
\itemize{
\item A \code{logical(1)} indicating whether to save the alignment to \code{.fasta} files.
\item A \code{character(1)} specifying the directory to save alignment files.
\item A \code{logical(1)} indicating whether to overwrite existing files at \code{output_path}
}}

\item{use_profiles}{A \code{logical(1)} or \code{character()} indicating whether to
add sequences to existing histone MSA profiles. If \code{TRUE}, uses the curated
alignments from HistoneDB 2.0 (2). Can also be a \code{character()} specifying
paths to custom, pre-aligned \code{.fasta} files.}

\item{nondefault_refseq_names}{An optional \code{character()} of non-default
reference sequence names. If \code{NULL}, H1.1 and canonical H2A/H2B/H3/H4 are
used. Be aware that changing this can change hPTM location definition!}

\item{return_only_original}{A \code{logical(1)} indicating whether to return only
the sequences present in \code{unaligned_histones} in the MSA. Optional, only
used in profile mode.}

\item{quiet}{A \code{logical(1)} indicating whether to suppress MAFFT output.}

\item{num_cores}{An \code{integer(1)} specifying the number of CPU cores to use
during alignment. Optional, \code{-1} uses all cores.}

\item{...}{Additional arguments passed to MAFFT, overriding any defaults.}
}
\value{
A list containing the unaligned input sequences (\code{unaligned}), the
multiple sequence alignment (\code{msa}), and optionally the aligned reference
sequences (\code{msa_ref}) if \code{use_profiles} is not \code{FALSE}. Each list element
is a named \code{AAStringSetList}. An error is raised if MAFFT fails alignment
for any histone family.
}
\description{
Histone sequences can be aligned to prevent location mismatches between
corresponding hPTMs, e.g, H31S57 vs. H3CS56.
}
\details{
To ensure consistent and accurate alignment regardless of the underlying
sequences, this alignment is by default added into a predefined MSA profile
using the MAFFT \code{--add} functionality (1). This predefined MSA profile is by
default the curated alignment of the corresponding histone family retrieved
from HistoneDB 2.0 (2).

It is therefore highly recommended to leave these settings at default, so
that hPTM definition will be consistent, even when the sequences to align
change.
}
\examples{
\dontrun{
# Align default human histone sequences from UniProt (reviewed entries only)
aligned_human_histones <- alignHistones()

# Align a custom set of histone sequences
library(Biostrings)
h3_seqs <- AAStringSet(c(H3.1-Ntail = "ARTKQTARKSTGGKAPRKQLATKAARKSAPATGGVKKPH",
                         H3.3-Ntail = "ARTKQTARKSTGGKAPRKQLATKAARKSAPSTGGVKKPH"))
h4_seqs <- AAStringSet(c(H4-Ntail = "SGRGKGGKGLGKGGAKRHRKVLRDNIQGITKPAIRR"))
unaligned_seqs <- AAStringSetList(H3 = h3_seqs, H4 = h4_seqs)
aligned_custom_seqs <- alignHistones(unaligned_histones = unaligned_seqs)

# Align mouse histones instead of human
mouse_unaligned <- histonesFromUniprot(query = c("organism_id:10090", "reviewed:true"))
aligned_mouse <- alignHistones(unaligned_histones = mouse_unaligned)

# Perform a de novo alignment instead of adding to a profile
denovo_aligned <- alignHistones(use_profiles = FALSE)

# Pass additional arguments to MAFFT, e.g., to change the gap opening penalty
alignHistones(op = 3.0)

# Use non-default reference sequences, note that this is not recommended!
alignHistones(
  nondefault_refseq_names = c(
    H1 = "H1.0|Bos|NP_001069955.1 Bos|NP_001069955.1|H1.0 Bos_H1.0_115496898",
    H2A = "H2A.1|Homo|NP_734466.1 Homo|NP_734466.1|H2A.1 Homo_H2A.1_25092737",
    H2B = "H2B.1|Canis|XP_005640164.1 Canis|XP_005640164.1|H2B.1 Canis_H2B.1_545554624",
    H3 = "H3.3|Arabidopsis|NP_195713.1 Arabidopsis|NP_195713.1|H3.3 Arabidopsis_H3.3_15236103",
    H4 = "canonical_H4|Mus|NP_291074.1 Mus|NP_291074.1|canonical_H4 Mus_canonical_H4_21361209"
  )
)
}
}
\references{
(1) Katoh, K.; Standley, D. M. MAFFT Multiple Sequence Alignment Software
Version 7: Improvements in Performance and Usability. Molecular Biology and
Evolution 2013, 30 (4), 772–780. \url{https://doi.org/10.1093/molbev/mst010}.

(2) Draizen, E. J.; Shaytan, A. K.; Mariño-Ramírez, L.; Talbert, P. B.;
Landsman, D.; Panchenko, A. R. HistoneDB 2.0: A Histone Database with
Variants—an Integrated Resource to Explore Histones and Their Variants.
Database (Oxford) 2016, 2016, baw014. \url{https://doi.org/10.1093/database/baw014}.
}
